#-----------------------------------------------#
################# PROG_NAME #####################
#-----------------------------------------------#
NAME = AwesomePhoneBook

#-----------------------------------------------#
################## COMPILO ######################
#-----------------------------------------------#
CXX = clang++

#-----------------------------------------------#
################## SOURCES ######################
#-----------------------------------------------#
SRCS +=		main.cpp							\
			PhoneBook.class.cpp					\
			Contact.class.cpp
vpath %.cpp $(PATH_SRCS)

#-----------------------------------------------#
################## OBJECTS ######################
#-----------------------------------------------#
OBJS = $(addprefix $(PATH_OBJS), $(SRCS:.cpp=.o))

#-----------------------------------------------#
################### FLAGS #######################
#-----------------------------------------------#
CXXFLAGS +=	-Wall -Wextra -Werror				\
			-std=c++98
ifeq ($(d), 0)
	CXXFLAGS	+= -Wpadded
	CXXFLAGS	+= -g3
	CXXFLAGS	+= -fsanitize=address,undefined
endif

#-----------------------------------------------#
################# INCLUDES ######################
#-----------------------------------------------#
INCLUDES	=	-I $(PATH_HEAD)					\


#-----------------------------------------------#
################### PATHS #######################
#-----------------------------------------------#
PATH_HEAD	=	./
PATH_SRCS	=	./
PATH_OBJS	=	./objects/

#-----------------------------------------------#
################# LIBRARIES #####################
#-----------------------------------------------#
ifeq ($(d), 0)
	LDFLAGS		+= -fsanitize=address,undefined
endif

#-----------------------------------------------#
################## HEADERS ######################
#-----------------------------------------------#
HEADERS		+=	PhoneBook.class.hpp				\
				Contact.class.hpp
vpath %.h $(PATH_HEAD)

#-----------------------------------------------#
################### RULES #######################
#-----------------------------------------------#

all: $(NAME)

$(NAME): $(OBJS)
	$(CXX) -o $@ $^ $(LDFLAGS) $(LDLIBS) $(CXXFLAGS)

$(PATH_OBJS)%.o: %.cpp
	$(CXX) -o $@ -c $< $(CXXFLAGS) $(INCLUDES)

$(OBJS): Makefile $(HEADERS) | $(PATH_OBJS)

$(PATH_OBJS):
	mkdir $@

clean:
	rm -rf $(PATH_OBJS)

fclean: clean
	rm -rf $(NAME)

re: fclean all

.PHONY: all clean fclean re
